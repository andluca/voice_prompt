#!/bin/bash
# Check project status and what's completed

cat << 'EOF'
ğŸ“Š Project Status
================================================================================
EOF

echo ""
echo "ğŸ“ Project Structure:"
echo "---"
# Check key files
files=(
    "SPEC.md"
    "README.md"
    "requirements.txt"
    "pyproject.toml"
    "config.yaml.example"
    ".claude/CLAUDE.md"
    "voice_prompt/__init__.py"
    "voice_prompt/config.py"
    "voice_prompt/recorder.py"
    "voice_prompt/transcriber.py"
    "voice_prompt/outputter.py"
    "voice_prompt/hotkey.py"
    "voice_prompt/main.py"
    "tests/test_config.py"
    "scripts/setup.sh"
    "scripts/setup.ps1"
)

for file in "${files[@]}"; do
    if [ -f "$file" ]; then
        echo "âœ… $file"
    else
        echo "âŒ $file"
    fi
done

echo ""
echo "ğŸ“¦ Dependencies:"
echo "---"
# Check if venv exists
if [ -d "venv" ]; then
    echo "âœ… Virtual environment exists"
    if [ -f "venv/bin/activate" ]; then
        source venv/bin/activate
        echo "âœ… Virtual environment activated"
    fi
else
    echo "âŒ No virtual environment (run: python -m venv venv)"
fi

# Check key dependencies
python -c "import yaml" 2>/dev/null && echo "âœ… PyYAML installed" || echo "âŒ PyYAML not installed"
python -c "import sounddevice" 2>/dev/null && echo "âœ… sounddevice installed" || echo "âŒ sounddevice not installed"
python -c "import pynput" 2>/dev/null && echo "âœ… pynput installed" || echo "âŒ pynput not installed"
python -c "from faster_whisper import WhisperModel" 2>/dev/null && echo "âœ… faster-whisper installed" || echo "âŒ faster-whisper not installed"

echo ""
echo "ğŸ§ª Tests:"
echo "---"
if [ -d "tests" ]; then
    test_count=$(find tests -name "test_*.py" | wc -l)
    echo "âœ… Tests directory exists ($test_count test files)"
else
    echo "âŒ No tests directory"
fi

echo ""
echo "ğŸ“‹ TODO Progress:"
echo "---"
if [ -f "TODO.md" ]; then
    completed=$(grep -c "- \[x\]" TODO.md || echo "0")
    total=$(grep -c "- \[" TODO.md || echo "0")
    echo "âœ… $completed / $total tasks completed"
    
    echo ""
    echo "Next tasks:"
    grep -A 3 "## Phase 2:" TODO.md | head -5
else
    echo "âŒ No TODO.md found"
fi

echo ""
echo "================================================================================
"
echo "Commands:"
echo "  ./.claude/commands/spec      # View specification"
echo "  ./.claude/commands/test      # Run tests"
echo "  ./.claude/commands/build     # Build component"
echo "  ./.claude/commands/status    # This command"
