#!/bin/bash
# Run tests for voice_prompt

cat << 'EOF'
ðŸ§ª Running Tests
================================================================================
EOF

# Check if tests directory exists
if [ ! -d "tests" ]; then
    echo "âš ï¸  No tests directory found. Creating structure..."
    mkdir -p tests
    touch tests/__init__.py
    echo "âœ… Created tests/ directory"
fi

# Check if pytest is installed
if ! python -c "import pytest" 2>/dev/null; then
    echo "ðŸ“¦ Installing pytest..."
    pip install pytest pytest-cov
fi

# Parse arguments
TEST_PATH="${1:-tests/}"
VERBOSE="${2:-}"

echo ""
echo "Test path: $TEST_PATH"
echo "================================================================================

"

# Run tests
if [ "$VERBOSE" = "-v" ] || [ "$VERBOSE" = "--verbose" ]; then
    pytest "$TEST_PATH" -v --cov=voice_prompt --cov-report=term-missing
else
    pytest "$TEST_PATH" --cov=voice_prompt --cov-report=term-missing
fi

echo ""
echo "================================================================================
"
echo "Usage: ./test [path] [-v]"
echo "  Examples:"
echo "    ./test                    # Run all tests"
echo "    ./test tests/test_config.py  # Run specific test file"
echo "    ./test -v                 # Run with verbose output"
